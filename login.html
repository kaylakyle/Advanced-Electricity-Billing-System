<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ElectroFlow login-page</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="auth-body">
  <div class="auth-container">
    <h1>ElectroFlow</h1>
    <p>Advanced Electricity Billing System</p>

    <!-- Login Form -->
    <form id="loginForm">
      <label for="username">Username</label><br>
      <input type="text" id="username" name="username" placeholder="Enter your Username" required><br><br>

      <label for="password">Password</label><br>
      <input type="password" id="password" name="password" placeholder="Enter your password" required><br><br>

      <label class="role" for="role">Role</label><br>
      <select id="role" name="role" required>
        <option value="Administrator">Administrator</option>
        <option value="Staff Member">Staff Member</option>
        <option value="Customer">Customer</option>
      </select><br><br>

      <button type="submit" id="loginBtn">Sign In</button>
    </form>

    <!-- OTP Form hidden at start -->
    <form id="otpForm" style="display:none; margin-top:20px;">
      <label for="otp">Enter OTP</label><br>
      <input type="text" id="otp" name="otp" placeholder="Enter OTP" required><br><br>
      <button type="submit">Verify OTP</button>
    </form>
  </div>

 <script>
    // Generate random 6-digit OTP
    function generateOTP() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }

    // Handle login form
    const loginForm = document.getElementById("loginForm");
    const otpForm = document.getElementById("otpForm");

    loginForm.addEventListener("submit", function(e) {
      e.preventDefault();

      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const role = document.getElementById("role").value;

      if (!username || !password) {
        alert("Please enter username and password!");
        return;
      }

      // Save username and role temporarily for OTP verification
      localStorage.setItem("tempUsername", username);
      localStorage.setItem("tempRole", role);

      // Generate OTP
      const otp = generateOTP();
      localStorage.setItem("generatedOTP", otp);

      alert("Your OTP is: " + otp); 

      // Show OTP form
      loginForm.style.display = "none";
      otpForm.style.display = "block";
    });

    // Handle OTP verification
    otpForm.addEventListener("submit", function(e) {
      e.preventDefault();

      const enteredOTP = document.getElementById("otp").value.trim();
      const storedOTP = localStorage.getItem("generatedOTP");

      if (enteredOTP === storedOTP) {
        // Save permanent login info
        localStorage.setItem("username", localStorage.getItem("tempUsername"));
        localStorage.setItem("userRole", localStorage.getItem("tempRole"));

        // Clean up temporary data
        localStorage.removeItem("generatedOTP");
        localStorage.removeItem("tempUsername");
        localStorage.removeItem("tempRole");

        alert(" Login successful!");
        window.location.href = "index.html";
      } else {
        alert(" Invalid OTP. Try again!");
      }
    });
  
  </script>
</body>
</html>
